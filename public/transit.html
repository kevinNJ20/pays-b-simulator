<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>🇲🇱 Mali - Transit - Bamako - Système d'Information Douanier</title>
    
    <!-- Script d'authentification -->
    <script src="/auth.js"></script>
    
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #14b53a 0%, #fcd116 50%, #ce1126 100%);
            min-height: 100vh;
            color: #333;
        }

        .container {
            max-width: 1800px;
            margin: 0 auto;
            padding: 20px;
        }

        .header {
            background: rgba(255, 255, 255, 0.95);
            padding: 30px;
            border-radius: 15px;
            text-align: center;
            margin-bottom: 20px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
            position: relative;
        }

        .header-logo {
            position: absolute;
            left: 30px;
            top: 50%;
            transform: translateY(-50%);
            width: 80px;
            height: 80px;
        }

        .user-info-container {
            position: absolute;
            top: 30px;
            right: 30px;
            z-index: 1000;
        }

        .mali-flag {
            width: 80px;
            height: 60px;
            display: flex;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.2);
            border-radius: 4px;
        }

        .flag-stripe {
            flex: 1;
        }

        .flag-green { background: #14b53a; }
        .flag-yellow { background: #fcd116; }
        .flag-red { background: #ce1126; }

        .header h1 {
            color: #2c3e50;
            margin-bottom: 10px;
            font-size: 2.5em;
        }

        .header p {
            color: #7f8c8d;
            font-size: 1.1em;
        }

        .workflow-badge {
            display: inline-block;
            background: linear-gradient(135deg, #ce1126 0%, #14b53a 100%);
            color: white;
            padding: 8px 16px;
            border-radius: 20px;
            font-weight: bold;
            margin-top: 10px;
        }

        .status-banner {
            padding: 15px;
            border-radius: 10px;
            margin-bottom: 20px;
            text-align: center;
            font-weight: bold;
            background: linear-gradient(135deg, #14b53a 0%, #fcd116 100%);
            color: #2c3e50;
        }

        .status-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 15px;
            margin-bottom: 20px;
        }

        .status-card {
            background: rgba(255, 255, 255, 0.95);
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 4px 16px rgba(0, 0, 0, 0.1);
            border-left: 4px solid #ce1126;
        }

        .status-card h3 {
            color: #2c3e50;
            margin-bottom: 10px;
            font-size: 1.2em;
        }

        .main {
            display: grid;
            grid-template-columns: 1fr;
            gap: 20px;
        }

        .card {
            background: rgba(255, 255, 255, 0.95);
            padding: 25px;
            border-radius: 15px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
        }

        .card.full-width {
            grid-column: 1 / -1;
        }

        .card h2 {
            color: #2c3e50;
            margin-bottom: 20px;
            font-size: 1.5em;
        }

        .btn {
            padding: 12px 24px;
            border: none;
            border-radius: 8px;
            font-size: 14px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            margin: 5px;
            text-decoration: none;
            display: inline-block;
        }

        .btn-mali {
            background: linear-gradient(135deg, #14b53a 0%, #ce1126 100%);
            color: white;
        }

        .btn-transit {
            background: linear-gradient(135deg, #fcd116 0%, #14b53a 100%);
            color: #2c3e50;
            font-size: 16px;
            padding: 15px 30px;
        }

        .btn-simple {
            background: #6c757d;
            color: white;
            font-size: 14px;
            padding: 10px 20px;
        }

        .btn:hover:not(:disabled) {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(20, 181, 58, 0.3);
        }

        .btn:disabled {
            opacity: 0.6;
            cursor: not-allowed;
        }

        .workflow-mali {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(100px, 1fr));
            gap: 15px;
            margin: 20px 0;
        }

        .workflow-step {
            background: #f8f9fa;
            padding: 15px;
            border-radius: 8px;
            text-align: center;
            border-left: 4px solid #ce1126;
            transition: all 0.3s;
        }

        .workflow-step.completed {
            background: #d4edda;
            border-left-color: #14b53a;
        }

        .workflow-step.manual {
            background: #fff3cd;
            border-left-color: #fcd116;
        }

        .step-number {
            width: 30px;
            height: 30px;
            background: #ce1126;
            color: white;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0 auto 10px;
            font-weight: bold;
            font-size: 0.85em;
        }

        .step-number.completed {
            background: #14b53a;
        }

        .step-number.manual {
            background: #fcd116;
            color: #2c3e50;
        }

        .step-content h4 {
            color: #2c3e50;
            font-size: 0.85em;
            margin-bottom: 5px;
        }

        .step-content p {
            color: #6c757d;
            font-size: 0.75em;
        }

        .transit-list {
            max-height: 400px;
            overflow-y: auto;
        }

        .transit-item {
            background: #f8f9fa;
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 10px;
            border-left: 4px solid #14b53a;
        }

        .transit-item.waiting {
            border-left-color: #ffc107;
        }

        .transit-item.arrived {
            border-left-color: #28a745;
        }

        .transit-item.complete {
            border-left-color: #6f42c1;
        }

        .item-header {
            font-weight: bold;
            color: #2c3e50;
            margin-bottom: 5px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .item-details {
            font-size: 0.9em;
            color: #6c757d;
            margin: 5px 0;
        }

        .item-status {
            padding: 3px 10px;
            border-radius: 12px;
            font-size: 0.85em;
            font-weight: bold;
        }

        .item-status.received {
            background: #d1ecf1;
            color: #0c5460;
        }

        .item-status.waiting {
            background: #fff3cd;
            color: #856404;
        }

        .item-status.arrived {
            background: #d4edda;
            color: #155724;
        }

        .item-status.complete {
            background: #e2d9f3;
            color: #5a3f8f;
        }

        /* Modales */
        .modal-overlay {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.7);
            z-index: 9998;
            animation: fadeIn 0.3s;
        }

        .modal-overlay.show {
            display: flex;
            align-items: center;
            justify-content: center;
        }

        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        .modal-container {
            background: white;
            border-radius: 15px;
            max-width: 700px;
            width: 90%;
            max-height: 90vh;
            overflow-y: auto;
            box-shadow: 0 10px 50px rgba(0, 0, 0, 0.3);
            animation: slideIn 0.3s;
        }

        @keyframes slideIn {
            from {
                transform: translateY(-50px);
                opacity: 0;
            }
            to {
                transform: translateY(0);
                opacity: 1;
            }
        }

        .modal-header {
            background: linear-gradient(135deg, #ce1126 0%, #14b53a 100%);
            color: white;
            padding: 25px;
            border-radius: 15px 15px 0 0;
            position: relative;
        }

        .modal-header h3 {
            margin: 0;
            font-size: 1.5em;
        }

        .modal-close {
            position: absolute;
            top: 15px;
            right: 15px;
            background: rgba(255, 255, 255, 0.2);
            border: none;
            color: white;
            font-size: 28px;
            cursor: pointer;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s;
        }

        .modal-close:hover {
            background: rgba(255, 255, 255, 0.3);
            transform: rotate(90deg);
        }

        .modal-body {
            padding: 30px;
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-group label {
            display: block;
            font-weight: 600;
            margin-bottom: 8px;
            color: #2c3e50;
        }

        .form-group label.required::after {
            content: " *";
            color: #ce1126;
        }

        .form-group input,
        .form-group select,
        .form-group textarea {
            width: 100%;
            padding: 12px;
            border: 2px solid #e9ecef;
            border-radius: 8px;
            font-size: 14px;
            transition: all 0.3s;
        }

        .form-group input:focus,
        .form-group select:focus,
        .form-group textarea:focus {
            border-color: #14b53a;
            outline: none;
            box-shadow: 0 0 0 3px rgba(20, 181, 58, 0.1);
        }

        .form-row {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
        }

        .form-section {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 10px;
            margin-bottom: 20px;
        }

        .form-section h4 {
            color: #2c3e50;
            margin-bottom: 15px;
            font-size: 1.2em;
            border-bottom: 2px solid #14b53a;
            padding-bottom: 10px;
        }

        .modal-footer {
            padding: 20px 30px;
            border-top: 1px solid #e9ecef;
            display: flex;
            justify-content: flex-end;
            gap: 10px;
        }

        .btn-cancel {
            background: #6c757d;
            color: white;
            padding: 12px 30px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 600;
        }

        .btn-submit {
            background: linear-gradient(135deg, #14b53a 0%, #0f9647 100%);
            color: white;
            padding: 12px 30px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 600;
        }

        .btn-submit:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 15px rgba(20, 181, 58, 0.3);
        }

        /* Résultats */
        .result-container {
            background: white;
            border-radius: 10px;
            padding: 20px;
            margin-top: 15px;
        }

        .result-header {
            display: flex;
            align-items: center;
            gap: 15px;
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 2px solid #14b53a;
        }

        .result-icon {
            font-size: 48px;
        }

        .result-title h3 {
            color: #2c3e50;
            margin-bottom: 5px;
        }

        .result-title p {
            color: #6c757d;
            font-size: 0.9em;
        }

        .result-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 15px;
        }

        .result-card {
            background: #f8f9fa;
            padding: 15px;
            border-radius: 8px;
            border-left: 4px solid #14b53a;
        }

        .result-card h4 {
            color: #2c3e50;
            font-size: 0.9em;
            margin-bottom: 10px;
            text-transform: uppercase;
        }

        .result-value {
            color: #495057;
            font-size: 1.1em;
            font-weight: 600;
        }

        .notification {
            position: fixed;
            top: 20px;
            right: 20px;
            padding: 15px 20px;
            border-radius: 8px;
            color: white;
            font-weight: 600;
            transform: translateX(400px);
            transition: transform 0.3s;
            z-index: 10000;
            max-width: 350px;
        }

        .notification.show {
            transform: translateX(0);
        }

        .notification.success {
            background: linear-gradient(135deg, #14b53a, #20c997);
        }

        .notification.error {
            background: linear-gradient(135deg, #ce1126, #fd7e14);
        }

        .notification.info {
            background: linear-gradient(135deg, #007bff, #6610f2);
        }

        .notification.warning {
            background: linear-gradient(135deg, #ffc107, #fd7e14);
        }

        .copyright {
            text-align: center;
            padding: 20px;
            margin-top: 30px;
            color: rgba(255, 255, 255, 0.8);
            font-size: 0.9em;
            background: rgba(0, 0, 0, 0.1);
            border-radius: 10px;
        }

        @media (max-width: 768px) {
            .workflow-mali {
                grid-template-columns: 1fr;
            }
            
            .header-logo, .user-info-container {
                position: static;
                transform: none;
                margin: 10px auto;
            }

            .form-row {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>

<body>
    <div class="container">
        <header class="header">
            <div class="header-logo">
                <div class="mali-flag">
                    <div class="flag-stripe flag-green"></div>
                    <div class="flag-stripe flag-yellow"></div>
                    <div class="flag-stripe flag-red"></div>
                </div>
            </div>
            
            <div class="user-info-container" id="user-info-container"></div>
            
            <h1>🇲🇱 Système d'Information Douanier Mali - Transit</h1>
            <p>🏛️ Bamako - Pays de Destination - Workflow Manuel</p>
            <div class="workflow-badge">ÉTAPES 8-13 : Traitement Manuel</div>
        </header>

        <div class="status-banner">
            ✅ Mali opérationnel - Workflow transit étapes 8-13 simplifié
        </div>

        <div class="status-grid">
            <div class="status-card">
                <h3>🇲🇱 Service Mali</h3>
                <div>Bamako - Actif</div>
                <small>Traitement manuel transit</small>
            </div>

            <div class="status-card">
                <h3>📊 Statistiques Transit</h3>
                <div>Reçus: <strong id="stat-recus">0</strong></div>
                <div>Arrivées: <strong id="stat-arrivees">0</strong></div>
                <div>Messages: <strong id="stat-messages">0</strong></div>
            </div>

            <div class="status-card">
                <h3>📈 Performance</h3>
                <div>Mode: <strong>MANUEL</strong></div>
                <div>Étapes: <strong>8-13</strong></div>
            </div>
        </div>

        <main class="main">
            <section class="card full-width">
                <h2>🚛 Workflow Transit Mali (Étapes 8-13)</h2>
                <p><strong>Étape 11</strong> déjà reçue - Traitement manuel des étapes suivantes</p>
                
                <div class="workflow-mali">
                    <div class="workflow-step manual" id="transit-step-8">
                        <div class="step-number manual">8</div>
                        <div class="step-content">
                            <h4>📋</h4>
                            <p>Déclaration</p>
                        </div>
                    </div>
                    
                    <div class="workflow-step manual" id="transit-step-9">
                        <div class="step-number manual">9</div>
                        <div class="step-content">
                            <h4>🛃</h4>
                            <p>Visa</p>
                        </div>
                    </div>
                    
                    <div class="workflow-step manual" id="transit-step-10">
                        <div class="step-number manual">10</div>
                        <div class="step-content">
                            <h4>🔍</h4>
                            <p>Vérif.</p>
                        </div>
                    </div>
                    
                    <div class="workflow-step manual" id="transit-step-11">
                        <div class="step-number manual">11</div>
                        <div class="step-content">
                            <h4>✓</h4>
                            <p>Valid.</p>
                        </div>
                    </div>
                    
                    <div class="workflow-step manual" id="transit-step-12">
                        <div class="step-number manual">12</div>
                        <div class="step-content">
                            <h4>✓</h4>
                            <p>Autoris.</p>
                        </div>
                    </div>
                    
                    <div class="workflow-step manual" id="transit-step-13">
                        <div class="step-number manual">13</div>
                        <div class="step-content">
                            <h4>📤</h4>
                            <p>Transmis.</p>
                        </div>
                    </div>
                </div>

                <div style="background: #e3f2fd; padding: 15px; border-radius: 8px; margin-top: 15px;">
                    <strong>ℹ️ Workflow simplifié :</strong><br>
                    • Étapes 8-9 : Formulaires complets<br>
                    • Étapes 10-12 : Validation simple (bouton "Suivant")<br>
                    • Étape 13 : Confirmation arrivée + Appel MuleSoft vers Sénégal
                </div>
            </section>

            <section class="card full-width">
                <h2>🎮 Workflow Transit Interactif</h2>
                <p>Exécutez chaque étape du workflow transit ou le workflow complet</p>
                
                <div style="background: #f8f9fa; padding: 15px; border-radius: 8px; margin-bottom: 20px;">
                    <label for="select-transit-mali"><strong>🚛 Sélectionner un transit :</strong></label>
                    <select id="select-transit-mali" style="width: 100%; padding: 10px; margin-top: 10px; border-radius: 5px; border: 1px solid #ddd;">
                        <option value="">-- Chargement des transits... --</option>
                    </select>
                    <button class="btn btn-mali" onclick="chargerTransitsDisponibles()" style="margin-top: 10px;">
                        🔄 Actualiser Liste
                    </button>
                </div>

                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(160px, 1fr)); gap: 15px; margin: 20px 0;">
                    <button class="btn btn-transit" onclick="ouvrirModalEtape8Transit()">
                        📋 ÉTAPE 8<br>Dépôt Déclaration
                    </button>
                    
                    <button class="btn btn-transit" onclick="ouvrirModalEtape9Transit()">
                        🛃 ÉTAPE 9<br>Visa Douanier
                    </button>
                    
                    <button class="btn btn-simple" onclick="validerEtape10Transit()">
                        ✓ ÉTAPE 10<br>Suivant
                    </button>
                    
                    <button class="btn btn-simple" onclick="validerEtape11Transit()">
                        ✓ ÉTAPE 11<br>Suivant
                    </button>
                    
                    <button class="btn btn-simple" onclick="validerEtape12Transit()">
                        ✓ ÉTAPE 12<br>Suivant
                    </button>
                    
                    <button class="btn btn-mali" onclick="confirmerArriveeEtTransmettreTransit()">
                        📤 ÉTAPE 13<br>Confirmer + MuleSoft
                    </button>
                </div>

                <div style="text-align: center; margin-top: 20px; padding-top: 20px; border-top: 2px solid #ddd;">
                    <button class="btn btn-transit" onclick="executerWorkflowTransitComplet()" id="btn-workflow-transit-complet" style="font-size: 18px; padding: 20px 40px;">
                        🚀 Exécuter Workflow Complet<br>
                        <small style="font-size: 12px;">(Étapes 8 à 13 en une fois)</small>
                    </button>
                </div>

                <div id="resultat-transit" style="margin-top: 20px; display: none;">
                    <!-- Affichage résultats -->
                </div>
            </section>

            <section class="card full-width">
                <h2>🚛 Déclarations Transit Reçues au Mali</h2>
                <div class="transit-list" id="transits-list">
                    <p style="text-align: center; padding: 20px; color: #6c757d;">
                        En attente de déclarations transit depuis le Sénégal...
                    </p>
                </div>
            </section>
        </main>

        <div class="copyright">
            © 2025 Jasmine Conseil - Prototype Mission d'Interconnexion UEMOA
        </div>
    </div>

    <!-- MODALES (seulement pour étapes 8 et 9) -->

    <!-- Modal ÉTAPE 8 -->
    <div id="modal-etape-8-transit" class="modal-overlay">
        <div class="modal-container">
            <div class="modal-header">
                <h3>📋 ÉTAPE 8 - Dépôt Déclaration Détaillée Transit</h3>
                <button class="modal-close" onclick="fermerModalTransit('modal-etape-8-transit')">&times;</button>
            </div>
            <div class="modal-body">
                <form id="form-etape-8-transit">
                    <div class="form-section">
                        <h4>Informations Déclaration</h4>
                        <div class="form-row">
                            <div class="form-group">
                                <label class="required">Numéro Déclaration Détaillée</label>
                                <input type="text" name="numeroDeclarationDetail" required>
                            </div>
                            <div class="form-group">
                                <label class="required">Déclarant Malien</label>
                                <input type="text" name="declarantMalien" value="DECLARANT_TRANSIT_MALI" required>
                            </div>
                        </div>
                        <div class="form-group">
                            <label class="required">Importateur Destination</label>
                            <input type="text" name="importateurDestination" value="IMPORTATEUR_MALI_TRANSIT" required>
                        </div>
                    </div>

                    <div class="form-section">
                        <h4>Détails Marchandises</h4>
                        <div class="form-row">
                            <div class="form-group">
                                <label>Code SH</label>
                                <input type="text" name="codeSH" value="8703210000">
                            </div>
                            <div class="form-group">
                                <label>Valeur Déclarée (FCFA)</label>
                                <input type="number" name="valeurDeclaree" value="500000">
                            </div>
                        </div>
                    </div>

                    <div class="form-section">
                        <h4>Documents Joints</h4>
                        <div class="form-row">
                            <div class="form-group">
                                <label>Connaissement</label>
                                <input type="text" name="connaissement">
                            </div>
                            <div class="form-group">
                                <label>Facture Commerciale</label>
                                <input type="text" name="factureCommerciale">
                            </div>
                        </div>
                        <div class="form-group">
                            <label>Certificat Origine</label>
                            <input type="text" name="certificatOrigine" value="CO_SEN_TRANS">
                        </div>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button class="btn-cancel" onclick="fermerModalTransit('modal-etape-8-transit')">Annuler</button>
                <button class="btn-submit" onclick="soumettreEtape8Transit()">✅ Déposer Déclaration</button>
            </div>
        </div>
    </div>

    <!-- Modal ÉTAPE 9 -->
    <div id="modal-etape-9-transit" class="modal-overlay">
        <div class="modal-container">
            <div class="modal-header">
                <h3>🛃 ÉTAPE 9 - Apposition Visa Douanier</h3>
                <button class="modal-close" onclick="fermerModalTransit('modal-etape-9-transit')">&times;</button>
            </div>
            <div class="modal-body">
                <form id="form-etape-9-transit">
                    <div class="form-section">
                        <h4>Informations Visa</h4>
                        <div class="form-row">
                            <div class="form-group">
                                <label class="required">Numéro Visa</label>
                                <input type="text" name="numeroVisa" required>
                            </div>
                            <div class="form-group">
                                <label class="required">Agent Douanier</label>
                                <input type="text" name="agentDouanier" value="AGENT_DOUANE_TRANSIT_MALI" required>
                            </div>
                        </div>
                    </div>

                    <div class="form-section">
                        <h4>Contrôles Itinéraire et Délai</h4>
                        <div class="form-row">
                            <div class="form-group">
                                <label>Itinéraire Vérifié</label>
                                <select name="itineraireVerifie">
                                    <option value="true">✅ Oui</option>
                                    <option value="false">❌ Non</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label>Itinéraire Conforme</label>
                                <select name="itineraireConforme">
                                    <option value="true">✅ Oui</option>
                                    <option value="false">❌ Non</option>
                                </select>
                            </div>
                        </div>
                    </div>

                    <div class="form-section">
                        <h4>Contrôles Documents</h4>
                        <div class="form-row">
                            <div class="form-group">
                                <label>Documents Complets</label>
                                <select name="documentsComplets">
                                    <option value="true">✅ Oui</option>
                                    <option value="false">❌ Non</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label>Documents Authentiques</label>
                                <select name="documentsAuthentiques">
                                    <option value="true">✅ Oui</option>
                                    <option value="false">❌ Non</option>
                                </select>
                            </div>
                        </div>
                    </div>

                    <div class="form-section">
                        <h4>Contrôles Marchandises</h4>
                        <div class="form-row">
                            <div class="form-group">
                                <label>Quantité Correspond</label>
                                <select name="quantiteCorrespond">
                                    <option value="true">✅ Oui</option>
                                    <option value="false">❌ Non</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label>Scellements Intacts</label>
                                <select name="scellementsIntacts">
                                    <option value="true">✅ Oui</option>
                                    <option value="false">❌ Non</option>
                                </select>
                            </div>
                        </div>
                    </div>

                    <div class="form-section">
                        <h4>Décision Visa</h4>
                        <div class="form-group">
                            <label class="required">Décision</label>
                            <select name="decisionVisa" required>
                                <option value="ACCORDE">✅ Accordé</option>
                                <option value="ACCORDE_AVEC_RESERVE">⚠️ Accordé avec Réserve</option>
                                <option value="REFUSE">❌ Refusé</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label>Observations</label>
                            <textarea name="observations" rows="3"></textarea>
                        </div>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button class="btn-cancel" onclick="fermerModalTransit('modal-etape-9-transit')">Annuler</button>
                <button class="btn-submit" onclick="soumettreEtape9Transit()">✅ Apposer Visa</button>
            </div>
        </div>
    </div>

    <!-- Notification -->
    <div id="notification-transit" class="notification"></div>

    <!-- Scripts -->
    <script src="/script-transit.js"></script>
    <script>
        window.addEventListener('DOMContentLoaded', async () => {
            console.log('🔐 [TRANSIT MALI] Vérification authentification...');
            
            const isAuth = await checkAuth('transit');
            if (!isAuth) {
                console.log('❌ [TRANSIT MALI] Non authentifié - redirection');
                return;
            }
            
            console.log('✅ [TRANSIT MALI] Authentification validée');
            displayUserInfo('user-info-container');
        });
    </script>
</body>
</html>